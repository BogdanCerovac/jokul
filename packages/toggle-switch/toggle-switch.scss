@import "~@fremtind/jkl-core/variables/_all.scss";
@import "~@fremtind/jkl-core/mixins/_all.scss";
@import "~@fremtind/jkl-core/_functions.scss";

$toggle-width: rem(40px);
$toggle-height: rem(24px);
$toggle-dot-size: rem(20px);
$toggle-wrapper-height: rem(48px);

$toggle-text-color: $svart;
$toggle-border-color: $svart;
$toggle-background-color: $hvit;
$toggle-active-background-color: $suksess--darkbg;
$toggle-dot-color: $svart;
$toggle-dot-mark-color: $hvit;
$toggle-focus-color: $info;
$toggle-disabled-color: $gra-50;

$toggle-text-color--inverted: $hvit;
$toggle-border-color--inverted: $hvit;
$toggle-background-color--inverted: $svart;
$toggle-active-background-color--inverted: $suksess;
$toggle-dot-color--inverted: $hvit;
$toggle-dot-mark-color--inverted: $svart;
$toggle-focus-color--inverted: $info--darkbg;
$toggle-disabled-color--inverted: $gra-60;

:root,
[data-theme="light"] {
    --toggle-text-color: #{$toggle-text-color};
    --toggle-border-color: #{$toggle-border-color};
    --toggle-background-color: #{$toggle-background-color};
    --toggle-background-color--active: #{$toggle-active-background-color};
    --toggle-dot-color: #{$toggle-dot-color};
    --toggle-dot-mark-color: #{$toggle-dot-mark-color};
    --toggle-focus-color: #{$toggle-focus-color};
    --toggle-disabled-color: #{$toggle-disabled-color};
}

[data-theme="dark"] {
    --toggle-text-color: #{$toggle-text-color--inverted};
    --toggle-border-color: #{$toggle-border-color--inverted};
    --toggle-background-color: #{$toggle-background-color--inverted};
    --toggle-background-color--active: #{$toggle-active-background-color--inverted};
    --toggle-dot-color: #{$toggle-dot-color--inverted};
    --toggle-dot-mark-color: #{$toggle-dot-mark-color--inverted};
    --toggle-focus-color: #{$toggle-focus-color--inverted};
    --toggle-disabled-color: #{$toggle-disabled-color--inverted};
}

.jkl-toggle-switch {
    @include reset-outline;
    cursor: pointer;
    position: relative;
    display: flex;
    height: $toggle-height;
    padding: 0;
    align-items: center;
    height: $toggle-wrapper-height;

    background-color: transparent;
    color: var(--toggle-text-color, $toggle-text-color);
    @include jkl-text-style("desktop/body");
    @include motion("standard", "expressive");
    transition-property: color;

    &__label {
        display: inline-block;
        width: 100%;
        white-space: nowrap;
        overflow-x: hidden;
        text-overflow: ellipsis;
    }

    &__pill {
        flex-shrink: 0;
        display: inline-block;
        position: relative;
        pointer-events: none;
        width: $toggle-width;
        height: $toggle-height;
        border-radius: 999px;
        margin-left: $component-spacing--large;
        background-color: var(--toggle-background-color, $toggle-background-color);

        @include motion("standard");
        transition-property: box-shadow;
        box-shadow: 0 0 0 rem(1px) var(--toggle-border-color, $toggle-border-color);
    }

    &__dot {
        display: inline-block;
        height: $toggle-dot-size;
        width: $toggle-dot-size;
        border-radius: 999px;
        background-color: var(--toggle-dot-color, $toggle-dot-color);
        position: absolute;
        top: rem(2px);
        left: rem(2px);

        @include motion("standard", "expressive");
        transition-property: transform, background-color;

        &::after {
            content: "";
            display: block;
            width: rem(10px);
            height: rem(1.5px);
            background-color: var(--toggle-dot-mark-color, $toggle-dot-mark-color);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);

            @include motion("standard", "expressive");
            transition-property: background-color;
        }
    }

    &:focus:not([disabled]),
    &:hover:not([disabled]) {
        --toggle-border-color: var(--toggle-focus-color);

        .jkl-toggle-switch__pill {
            box-shadow: 0 0 0 rem(2px) var(--toggle-border-color, $toggle-focus-color);
        }
    }

    &[disabled] {
        cursor: auto;
        --toggle-text-color: var(--toggle-disabled-color);
        --toggle-border-color: var(--toggle-disabled-color);
        --toggle-dot-color: var(--toggle-disabled-color);
        --toggle-background-color--active: var(--toggle-background-color);
    }

    &[aria-pressed="true"] {
        --toggle-background-color: var(--toggle-background-color--active);
        .jkl-toggle-switch__dot {
            transform: translateX(rem(16px)) rotate(90deg);
        }
    }

    /// LEGACY CODE FOR IE11
    /// Ensures correct color values in IE11 for different states and inverted
    /// mode, while still allowing any theme using custom properties to take precedence
    &[disabled] {
        color: var(--toggle-text-color, $toggle-disabled-color);
        .jkl-toggle-switch__pill {
            background-color: var(--toggle-background-color, $toggle-background-color);
            box-shadow: 0 0 0 rem(1px) var(--toggle-border-color, $toggle-disabled-color);
        }
        .jkl-toggle-switch__dot {
            background-color: var(--toggle-dot-color, $toggle-disabled-color);
        }
    }
    &--inverted {
        color: var(--toggle-text-color, $toggle-text-color--inverted);
        .jkl-toggle-switch__pill {
            background-color: var(--toggle-background-color, $toggle-background-color--inverted);
            box-shadow: 0 0 0 rem(1px) var(--toggle-border-color, $toggle-border-color--inverted);
        }
        .jkl-toggle-switch__dot {
            background-color: var(--toggle-dot-color, $toggle-dot-color--inverted);
            &::after {
                background-color: var(--toggle-dot-mark-color, $toggle-dot-mark-color--inverted);
            }
        }
        &[aria-pressed="true"] {
            .jkl-toggle-switch__pill {
                background-color: var(--toggle-background-color--active, $toggle-active-background-color--inverted);
            }
        }
        &:focus:not([disabled]),
        &:hover:not([disabled]) {
            .jkl-toggle-switch__pill {
                box-shadow: 0 0 0 rem(2px) var(--toggle-border-color, $toggle-focus-color--inverted);
            }
        }
        &[disabled] {
            color: var(--toggle-text-color, $toggle-disabled-color--inverted);
            .jkl-toggle-switch__pill {
                background-color: transparent;
                box-shadow: 0 0 0 rem(1px) var(--toggle-border-color, $toggle-disabled-color--inverted);
            }
            .jkl-toggle-switch__dot {
                background-color: var(--toggle-dot-color, $toggle-disabled-color--inverted);
            }
        }
    }
    /// end of legacy code
}
